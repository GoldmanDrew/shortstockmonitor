apiVersion: batch/v1
kind: CronJob
metadata:
  name: shortstockmonitor
spec:
  schedule: "39 0 * * *"  # run daily at 12:00 UTC
  jobTemplate:
    spec:
      template:
        spec:
          restartPolicy: Never
          containers:
            - name: shortstockmonitor
              image: YOUR_DOCKER_REPO/shortstockmonitor:latest
              env:
                # Where the tickers CSV lives inside the image
                - name: TICKER_FILE
                  value: "/app/config/tickers.csv"

                # Optional threshold envs (tune as desired)
                - name: BORROW_ABS_THRESHOLD
                  value: "0.30"
                - name: BORROW_CHANGE_THRESHOLD
                  value: "0.05"
                - name: AVAIL_ABS_THRESHOLD
                  value: "10000"
                - name: AVAIL_CHANGE_THRESHOLD
                  value: "50000"

                # Email settings â€“ you'll likely move these to a Secret
                - name: EMAIL_FROM
                  value: "dag5wd@virginia.edu"
                - name: EMAIL_TO
                  value: "dag5wd@virginia.edu"
                - name: SMTP_HOST
                  value: "smtp.gmail.com"
                - name: SMTP_PORT
                  value: "587"
                - name: SMTP_USER
                  valueFrom:
                    secretKeyRef:
                      name: shortstockmonitor-email
                      key: smtp_user
                - name: SMTP_PASS
                  valueFrom:
                    secretKeyRef:
                      name: shortstockmonitor-email
                      key: smtp_pass
